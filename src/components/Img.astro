---
// 記事中の画像を適切なサイズで表示します。
//
// 用意する画像サイズは https://docs.astro.build/en/reference/configuration-reference/#imagebreakpoints を参照しています。
//
// sizesの960pxは記事表示領域がギリギリ縮まないときの画面幅です。
// これより大きい画面では記事表示領域が830pxになるため、830pxを最大幅としています。
// これより小さい画面では記事表示領域も縮まるため、100vwとしています。(ビューポート幅とpxしか指定できないため)
// autoは自動的に適切なサイズを選択してくれる便利な値ですが、対応ブラウザが少ないため上記の値をフォールバックとして使用しています。

import type { ImageMetadata } from "astro";
import { Image } from "astro:assets";

interface Props {
	src: ImageMetadata | string;
	alt: string;
	title?: string;
}

const { src, alt, title } = Astro.props;
---

{
	typeof src !== "string" ? (
		<Image
			src={src}
			widths={[
				640, 750, 828, 960, 1080, 1280, 1668, 1920, 2048, 2560, 3200, 3840,
				4480, 5120, 6016,
			]}
			sizes="auto, (min-width: 960px) 830px, 100vw"
			alt={alt}
			title={title}
		/>
	) : (
		<Image inferSize src={src} alt={alt} title={title} />
	)
}
