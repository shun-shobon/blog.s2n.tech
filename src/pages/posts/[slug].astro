---
import { getCollection, getEntry, render } from "astro:content";

import GlobalLayout from "@/layouts/GlobalLayout.astro";

export async function getStaticPaths() {
	const posts = await getCollection("posts");

	return posts.map((post) => ({ params: { slug: post.id } }));
}

const { slug } = Astro.params;
if (!slug) {
	return Astro.redirect("/404");
}

const posts = await getEntry("posts", slug);
if (!posts) {
	return Astro.redirect("/404");
}

const { Content } = await render(posts);
---

<GlobalLayout>
	<Content />
</GlobalLayout>
